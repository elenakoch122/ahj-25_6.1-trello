{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-25_6.1-trello/./node_modules/uuid/dist/esm-browser/native.js","webpack://ahj-25_6.1-trello/./node_modules/uuid/dist/esm-browser/rng.js","webpack://ahj-25_6.1-trello/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://ahj-25_6.1-trello/./node_modules/uuid/dist/esm-browser/v4.js","webpack://ahj-25_6.1-trello/./src/js/Card.js","webpack://ahj-25_6.1-trello/./src/js/GhostElem.js","webpack://ahj-25_6.1-trello/./src/js/DragElem.js","webpack://ahj-25_6.1-trello/./src/js/State.js","webpack://ahj-25_6.1-trello/./src/js/Board.js","webpack://ahj-25_6.1-trello/./src/js/app.js","webpack://ahj-25_6.1-trello/./src/js/StateService.js"],"sourcesContent":["const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n","export default class Card {\n  constructor(text, column, id) {\n    this.text = text;\n    this.column = column;\n    this.id = id;\n  }\n\n  create() {\n    const card = document.createElement('div');\n    card.classList.add('column__card');\n    card.setAttribute('data-id', this.id);\n    card.textContent = this.text;\n\n    const close = document.createElement('span');\n    close.classList.add('close', 'column__card-close');\n\n    card.append(close);\n\n    return card;\n  }\n}\n","/* eslint-disable class-methods-use-this */\nexport default class GhostElem {\n  constructor(elem) {\n    this.elem = this.createGhost(elem);\n  }\n\n  createGhost(elem) {\n    const ghost = document.createElement('div');\n    ghost.classList.add('ghost');\n    ghost.style.width = `${elem.offsetWidth}px`;\n    ghost.style.height = `${elem.offsetHeight}px`;\n    return ghost;\n  }\n\n  delete() {\n    this.elem.remove();\n  }\n}\n","import GhostElem from './GhostElem';\n\nexport default class DragElem {\n  constructor(elem, x, y) {\n    this.elem = elem;\n    this.shiftX = x;\n    this.shiftY = y;\n    this.ghost = new GhostElem(elem);\n    this.card = null;\n    this.index = null;\n  }\n\n  bindToDOM() {\n    this.elem.parentElement.insertBefore(this.ghost.elem, this.elem);\n    this.elem.classList.add('dragged');\n    this.shiftX -= this.elem.offsetLeft;\n    this.shiftY -= this.elem.offsetTop - this.elem.offsetHeight - 7;\n    this.elem.style.left = '0px';\n    this.elem.style.top = `${this.elem.offsetTop - this.elem.offsetHeight - 7}px`;\n  }\n\n  move(x, y) {\n    this.elem.style.left = `${x - this.shiftX}px`;\n    this.elem.style.top = `${y - this.shiftY}px`;\n  }\n\n  clear() {\n    this.elem.removeAttribute('style');\n    this.elem.classList.remove('dragged');\n  }\n}\n","export default class State {\n  constructor() {\n    this.cards = [];\n  }\n}\n","/* eslint-disable class-methods-use-this */\nimport { v4 as uuidv4 } from 'uuid';\nimport Card from './Card';\nimport DragElem from './DragElem';\nimport State from './State';\n\nexport default class Board {\n  constructor(stateService) {\n    this.element = document.querySelector('.board');\n    this.stateService = stateService;\n    this.state = new State();\n    this.dragEl = null;\n    this.underDrag = null;\n    this.isColumn = null;\n    this.isColumnCardUnderDrag = null;\n    this.isColumnFooterElemUnderDrag = null;\n    this.isColumnFooterUnderDrag = null;\n\n    this.onClickCardDelete = this.onClickCardDelete.bind(this);\n    this.onClickFooter = this.onClickFooter.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n  }\n\n  static get markupSaveBtn() {\n    return `\n    <textarea class=\"column__add-textarea\" cols=\"30\" rows=\"4\" placeholder=\"Напишите задачу...\"></textarea>\n    <button class=\"column__save\">Добавить</button>\n    <span class=\"close column__add-close\"></span>\n    `;\n  }\n\n  static get markupAddBtn() {\n    return `\n    <button class=\"column__add\">Добавить задачу</button>\n    `;\n  }\n\n  init() {\n    const blocksWithCards = this.element.querySelectorAll('.column__cards');\n    const footers = this.element.querySelectorAll('.column__footer');\n\n    blocksWithCards.forEach((card) => {\n      card.addEventListener('mousedown', this.onMouseDown);\n      card.addEventListener('click', this.onClickCardDelete);\n    });\n    footers.forEach((f) => f.addEventListener('click', this.onClickFooter));\n\n    window.addEventListener('beforeunload', () => {\n      this.stateService.save(this.state);\n    });\n\n    document.addEventListener('DOMContentLoaded', () => {\n      const { cards } = this.stateService.load();\n\n      if (cards.length > 0) {\n        this.drawCards(cards);\n      }\n    });\n  }\n\n  onMouseDown(e) {\n    if (!e.target.classList.contains('column__card')) return;\n\n    e.preventDefault();\n    document.documentElement.style.cursor = 'grabbing';\n    this.dragEl = new DragElem(e.target, e.clientX, e.clientY);\n    this.dragEl.card = this.state.cards.find((c) => c.id === this.dragEl.elem.getAttribute('data-id'));\n    this.dragEl.index = this.state.cards.indexOf(this.dragEl.card);\n\n    this.dragEl.bindToDOM(e.clientX, e.clientY);\n    document.documentElement.addEventListener('mouseup', this.onMouseUp);\n    document.documentElement.addEventListener('mousemove', this.onMouseMove);\n  }\n\n  onMouseMove(e) {\n    this.dragEl.move(e.clientX, e.clientY);\n    this.renderGhost(e.target);\n  }\n\n  onMouseUp() {\n    document.documentElement.style.cursor = 'auto';\n\n    if (this.underDrag.tagName !== 'HTML' && this.underDrag.tagName !== 'BODY') {\n      if (this.isGhostUnderDrag) {\n        if (this.underDrag.nextElementSibling) {\n          this.underDrag = this.underDrag.nextElementSibling;\n        } else {\n          this.underDrag = this.underDrag.closest('.column').querySelector('.column__footer');\n        }\n      }\n\n      this.isColumnCardUnderDrag = this.underDrag.parentElement.classList.contains('column__cards');\n      this.isColumnFooterElemUnderDrag = this.underDrag.parentElement.classList.contains('column__footer');\n      this.isColumnFooterUnderDrag = this.underDrag.classList.contains('column__footer');\n      this.isGhostUnderDrag = this.underDrag.classList.contains('ghost');\n\n      this.dragEl.ghost.delete();\n\n      if (this.isColumnCardUnderDrag) {\n        this.changeOrderInState('column__cards', this.underDrag);\n        this.underDrag.parentElement.insertBefore(this.dragEl.elem, this.underDrag);\n        this.dragEl.ghost.delete();\n      }\n\n      if (this.isColumnFooterElemUnderDrag) {\n        this.dragEl.ghost.delete();\n        const columnCards = this.underDrag.parentElement.parentElement.querySelector('.column__cards');\n        this.changeOrderInState('column__footer', columnCards.children[columnCards.children.length - 1]);\n        columnCards.append(this.dragEl.elem);\n      }\n\n      if (this.isColumnFooterUnderDrag) {\n        this.dragEl.ghost.delete();\n        const columnCards = this.underDrag.parentElement.querySelector('.column__cards');\n        this.changeOrderInState('column__footer', columnCards.children[columnCards.children.length - 1]);\n        columnCards.append(this.dragEl.elem);\n      }\n    }\n    this.clearElements();\n\n    document.documentElement.removeEventListener('mouseup', this.onMouseUp);\n    document.documentElement.removeEventListener('mousemove', this.onMouseMove);\n  }\n\n  renderGhost(target) {\n    this.isColumn = !!target.closest('.column');\n\n    if (this.isColumn) {\n      this.underDrag = target;\n      this.isColumnCardUnderDrag = this.underDrag.parentElement.classList.contains('column__cards');\n      this.isColumnFooterElemUnderDrag = this.underDrag.parentElement.classList.contains('column__footer');\n      this.isColumnFooterUnderDrag = this.underDrag.classList.contains('column__footer');\n      this.isGhostUnderDrag = this.underDrag.classList.contains('ghost');\n\n      if (this.isColumnCardUnderDrag) {\n        this.underDrag.parentElement.insertBefore(this.dragEl.ghost.elem, this.underDrag);\n      }\n\n      if (this.isColumnFooterElemUnderDrag) {\n        this.underDrag.parentElement.parentElement.querySelector('.column__cards').append(this.dragEl.ghost.elem);\n      }\n\n      if (this.isColumnFooterUnderDrag) {\n        this.underDrag.parentElement.querySelector('.column__cards').append(this.dragEl.ghost.elem);\n      }\n    }\n  }\n\n  changeOrderInState(block, card) {\n    let slidingCard;\n    let slidingCardIdx;\n\n    if (card) {\n      slidingCard = this.state.cards.find((c) => c.id === card.getAttribute('data-id'));\n      slidingCardIdx = this.state.cards.indexOf(slidingCard);\n    }\n    const delActualEl = this.state.cards.splice(this.dragEl.index, 1)[0];\n\n    if (block === 'column__cards') {\n      if (slidingCardIdx > this.dragEl.index) {\n        this.state.cards.splice(slidingCardIdx - 1, 0, delActualEl);\n      } else {\n        this.state.cards.splice(slidingCardIdx, 0, delActualEl);\n      }\n    }\n\n    if (block === 'column__footer') {\n      if (!card) {\n        this.state.cards.unshift(delActualEl);\n      } else {\n        this.state.cards.splice(slidingCardIdx + 1, 0, delActualEl);\n      }\n    }\n\n    if (this.underDrag.classList.contains('column__footer')) {\n      this.dragEl.card.column = this.underDrag.parentElement.className;\n    } else {\n      this.dragEl.card.column = this.underDrag.parentElement.parentElement.className;\n    }\n  }\n\n  clearElements() {\n    this.dragEl.clear();\n    this.dragEl = null;\n    this.underDrag = null;\n    this.isColumn = null;\n    this.isColumnCardUnderDrag = null;\n    this.isColumnFooterElemUnderDrag = null;\n    this.isColumnFooterUnderDrag = null;\n  }\n\n  onClickCardDelete(e) {\n    if (!e.target.classList.contains('column__card-close')) return;\n    this.deleteCard(e.target);\n  }\n\n  deleteCard(target) {\n    const card = target.closest('.column__card');\n    const cardID = card.getAttribute('data-id');\n    this.state.cards = this.state.cards.filter((c) => c.id !== cardID);\n    card.remove();\n  }\n\n  onClickFooter(e) {\n    if (e.target.classList.contains('column__add') || e.target.classList.contains('column__add-close')) {\n      this.changeFooter(e.target);\n    }\n\n    if (e.target.classList.contains('column__save')) this.onClickSave(e.target);\n  }\n\n  changeFooter(target) {\n    const footer = target.closest('.column__footer');\n\n    if (footer.children.length === 1) {\n      target.remove();\n      footer.insertAdjacentHTML('beforeend', Board.markupSaveBtn);\n      return;\n    }\n\n    if (footer.children.length > 1) {\n      [...footer.children].forEach((child) => child.remove());\n      footer.insertAdjacentHTML('beforeend', Board.markupAddBtn);\n    }\n  }\n\n  onClickSave(target) {\n    const column = target.closest('.column');\n    const columnCards = column.querySelector('.column__cards');\n    const msg = column.querySelector('.column__add-textarea').value;\n    const card = new Card(msg, column.className, uuidv4());\n\n    this.state.cards.push(card);\n\n    columnCards.append(card.create());\n\n    this.changeFooter(target);\n  }\n\n  drawCards(cards) {\n    cards.forEach((c) => {\n      const card = new Card(c.text, c.column, uuidv4());\n      this.state.cards.push(card);\n      const columns = document.querySelectorAll('.column');\n      const findColumn = [...columns].find((col) => col.className === card.column);\n      findColumn.querySelector('.column__cards').append(card.create());\n    });\n  }\n}\n","import Board from './Board';\nimport StateService from './StateService';\n\nconst stateService = new StateService(localStorage);\nconst board = new Board(stateService);\nboard.init();\n","export default class StateService {\n  constructor(storage) {\n    this.storage = storage;\n  }\n\n  save(state) {\n    this.storage.setItem('cards', JSON.stringify(state));\n  }\n\n  load() {\n    try {\n      return JSON.parse(this.storage.getItem('cards'));\n    } catch (e) {\n      throw new Error('Invalid state');\n    }\n  }\n}\n"],"names":["randomUUID","crypto","bind","getRandomValues","rnds8","Uint8Array","byteToHex","i","push","toString","slice","options","buf","offset","rnds","random","rng","Error","length","RangeError","arr","toLowerCase","unsafeStringify","Card","constructor","text","column","id","this","create","card","document","createElement","classList","add","setAttribute","textContent","close","append","GhostElem","elem","createGhost","ghost","style","width","offsetWidth","height","offsetHeight","delete","remove","DragElem","x","y","shiftX","shiftY","index","bindToDOM","parentElement","insertBefore","offsetLeft","offsetTop","left","top","move","clear","removeAttribute","State","cards","Board","stateService","element","querySelector","state","dragEl","underDrag","isColumn","isColumnCardUnderDrag","isColumnFooterElemUnderDrag","isColumnFooterUnderDrag","onClickCardDelete","onClickFooter","onMouseDown","onMouseMove","onMouseUp","markupSaveBtn","markupAddBtn","init","blocksWithCards","querySelectorAll","footers","forEach","addEventListener","f","window","save","load","drawCards","e","target","contains","preventDefault","documentElement","cursor","clientX","clientY","find","c","getAttribute","indexOf","renderGhost","tagName","isGhostUnderDrag","nextElementSibling","closest","changeOrderInState","columnCards","children","clearElements","removeEventListener","block","slidingCard","slidingCardIdx","delActualEl","splice","unshift","className","deleteCard","cardID","filter","changeFooter","onClickSave","footer","insertAdjacentHTML","child","msg","value","uuidv4","col","storage","setItem","JSON","stringify","parse","getItem","localStorage"],"sourceRoot":""}